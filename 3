import pandas as pd
import matplotlib.pyplot as plt
import numpy as np
from sklearn.model_selection import train_test_split
from sklearn.tree import DecisionTreeClassifier
from sklearn.metrics import confusion_matrix, ConfusionMatrixDisplay, accuracy_score
from sklearn.metrics import classification_report
from sklearn.tree import plot_tree

m = pd.read_csv("Admission_Predict.csv")
m.head()

m.describe()

m = m.drop(columns=["Serial No.","TOEFL Score", "SOP", "LOR ", "Research","University Rating"], errors='ignore')
display(m[["GRE Score","CGPA"]])


desc = m['Chance of Admit'].describe()
threshold = desc['75%']
print("75th percentile of Chance of Admit:", threshold)

m["Chance of Admit"] = (m["Chance of Admit"] >= threshold).astype(int)
display(m[["GRE Score", "CGPA"]])


X = m.drop(columns=["Chance of Admit"])
y = m["Chance of Admit"]
y.value_counts()

X_train,X_test,y_train,y_test = train_test_split(X,y,random_state=42,test_size=0.25)
classifier = DecisionTreeClassifier(
    criterion='gini',
    random_state=42,
    max_depth=5,
    min_samples_leaf=10,
    min_samples_split=20
)
classifier.fit(X_train, y_train)

y_pred = classifier.predict(X_test)
print("Accuracy:", accuracy_score(y_test, y_pred))
print("\nConfusion Matrix:\n", confusion_matrix(y_test, y_pred))
print("\nClassification Report:\n", classification_report(y_test, y_pred))


plt.figure(figsize=(15,15))
plot_tree(classifier,fontsize=8,filled=True,rounded=True,feature_names=X.columns);
plt.show()


# Using Entropy
classifier = DecisionTreeClassifierclassifier = DecisionTreeClassifier(
    criterion='entropy',
    random_state=42,
    max_depth=5,
    min_samples_leaf=10,
    min_samples_split=20
)
classifier.fit(X_train, y_train)


y_pred = classifier.predict(X_test)
print("Accuracy:", accuracy_score(y_test, y_pred))
print("\nConfusion Matrix:\n", confusion_matrix(y_test, y_pred))
print("\nClassification Report:\n", classification_report(y_test, y_pred))


plt.figure(figsize=(15,15))
plot_tree(classifier,fontsize=8,filled=True,rounded=True,feature_names=X.columns)
plt.show()
